!function(r){function p(t,e){this.it=t,this.init(e)}var i,n={api:"https://api-maps.yandex.ru/2.1/?lang=ru_RU",zoomAfter:"click",event:!1,placemarkDefaults:{},map:{center:[],zoom:5},placemark:[{geometry:[],properties:{},options:{}}]},t=p.prototype;t.init=function(t){var e=this,a=e.it,a=r(a);!0!==e.inited&&(e.defaults=r.extend(!0,{},n,r.fn.eyMaps.defaults),e.options=t||{},e.dataOptions=a.data("eymaps")||{},e.settings=t=r.extend(!0,{},e.defaults,e.options,e.dataOptions),e.nsid=i.getRndNum(1e4,99999),e.nspc="eym-"+e.nsid,e.mpid="eymaps-id-"+e.nsid,e.map={},a.trigger("beforeInit.eym",[e]),a.addClass("eymaps"),a.attr("id")?e.mpid=a.attr("id"):a.attr("id",e.mpid),t.event?a.one(t.event+"."+e.nspc,function(){e.load.call(e)}):e.load.call(e),e.inited=!0,a.trigger("afterInit.eym",[e]))},t.load=function(){var t=this,e=(r(t.it),t.settings),a=r('script[src="'+e.api+'"]');a.length&&"object"==typeof ymaps?t.loadMAP():a.length&&"object"!=typeof ymaps?a.on("load",function(){t.loadMAP.call(t)}):t.loadAPI(e.api,function(){t.loadMAP.call(t)})},t.loadAPI=function(t,e){r(this.it);var a=this.settings,a=r("<script/>").attr("src",t||a.api).get(0);document.body.appendChild(a),a.onload=function(){"function"==typeof e&&e()}},t.loadMAP=function(){var a=this,t=r(a.it),i=a.settings;null==a.it.firstChild&&ymaps.ready(function(){t.trigger("beforeLoad.eym",[a]),a.map=new ymaps.Map(a.mpid,i.map),i.zoomAfter&&(a.map.behaviors.disable("scrollZoom"),a.map.container._parentElement.addEventListener(i.zoomAfter,function(){a.map.behaviors.isEnabled("scrollZoom")||a.map.behaviors.enable("scrollZoom")})),"object"==typeof i.placemark[0].geometry&&2===i.placemark[0].geometry.length&&r.each(i.placemark,function(t,e){e=new ymaps.Placemark(e.geometry,e.properties,r.extend({},i.placemarkDefaults,e.options));a.map.geoObjects.add(e)}),t.trigger("afterLoad.eym",[a,a.map])})},t.destroy=function(){var t=this,e=r(t.it);t.inited&&(e.attr("id")==t.mpid&&e.attr("id").match(/eymaps\-id/gim)&&e.removeAttr("id"),e.removeClass("eymaps").off(t.settings.event+"."+t.nspc).empty(),delete t.it.EyMaps)},t.reinit=function(t){var e=this,t=(e.it,"object"==typeof t&&0!=Object.keys(t).length?t:r.extend(!0,{},e.settings));e.destroy(),r(e.it).eyMaps(t)},i={getRndNum:function(t,e){return Math.round(t-.5+Math.random()*(e-t+1))}},r.fn.eyMaps=function(){var i="EyMaps",a=arguments,n=a[0];function o(t,e,a){return t[i]instanceof p&&(e in t[i]&&t[i][e].apply(t[i],Array.prototype.slice.call(a,1)))}function s(t,e){if(!(t[i]instanceof p))return new p(t,e)}return r.each(this,function(t,e){"object"==typeof n||void 0===n?e[i]=s(e,n):"init"!==n&&"reinit"!==n||e[i]?o(e,n,a):e[i]=s(e,a[1])}),this},r.fn.eyMaps.defaults=n}(jQuery);